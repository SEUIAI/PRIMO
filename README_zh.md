# PRIMO：用于多跳开放规则生成的渐进式归纳方法

本仓库包含**PRIMO**的实现，它是一种用于多跳开放规则生成的渐进式多阶段方法。该方法在论文《PRIMO: Progressive Induction for Multi-hop Open Rule Generation》（LREC-COLING 2024）中提出，旨在提高生成的多跳开放规则的质量、多样性和逻辑一致性。

## 背景

开放规则是指将前提原子映射到假设原子的逻辑推理规则，用于捕捉自然语言中实体之间的关系。现有的开放规则生成方法存在几个局限性：
1. **单跳限制**：现有模型主要集中于单跳规则生成，限制了其在复杂场景中的应用。
2. **逻辑不一致性**：多跳生成常常引入前提和假设原子之间的矛盾。
3. **语义重复**：生成的规则原子缺乏多样性，导致输出冗余。

为了应对这些问题，PRIMO提出了一个**渐进式多阶段框架**，包含三个模块：
- **生成**：根据前提原子生成描述性的假设原子文本。
- **提取**：从第一阶段生成的文本中提取假设原子。
- **排序**：评估并排序候选的假设原子，以确保逻辑一致性和多样性。

## 方法论

### 关键特性
- **本体集成**：将实体类型信息集成到提示中，以提高规则的准确性并减少歧义。
- **渐进式框架**：通过生成、提取和排序模块逐步完善规则生成。
- **人类反馈强化学习（RLHF）**：通过人类反馈微调模型，优化生成质量。

## 评估

### 数据集
论文介绍了一个基准数据集，包含495个前提原子和2851个样本。每个样本包括：
- 前提原子
- 实体类型
- 包含1到5跳的开放规则链

### 结果
| 我们的数据集             | B1   | B2   | B4   | RL   | Self-B2 |
|-------------------------|------|------|------|------|---------|
| **Prompt**              | 33.0 | 13.2 | 0.1  | 39.2 | 89.2    |
| **COMET**               | 35.1 | 13.6 | 1.1  | 42.9 | 92.6    |
| **Orion**               | 39.9 | **19.5** | 0.1  | 52.5 | 86.4    |
| **Vicuna-13B**          | **44.8** | 17.4 | **2.9** | **67.9** | 75.5    |
| **PRIMO**               | 44.3 | 16.5 | 2.1  | 66.3 | 80.5    |
| **PRIMO-without RLHF**  | 42.5 | 15.0 | 2.0  | 64.5 | 77.7    |
| **PRIMO-train G_Net**   | 43.4 | 14.1 | 1.3  | 66.3 | 77.8    |
| **PRIMO-train E_Net**   | 40.7 | 15.1 | 2.4  | 62.1 | **70.7** |

## 文件和目录
* `trl_rule/`: 包含用于对模型进行强化学习的函数。
* `dataset/`: 包含模型训练的数据集和测试基准。
* `gen_openrule`: 用于生成多跳开放规则的模块。

## 引用
如果您觉得这项工作有用，请引用以下文献：
```
@inproceedings{liu2024primo,
  title={PRIMO: Progressive Induction for Multi-hop Open Rule Generation},
  author={Liu, Jianyu and Bi, Sheng and Qi, Guilin},
  booktitle={Proceedings of LREC-COLING 2024},
  year={2024},
  pages={12988--12998}
}
```

## 致谢
PRIMO借鉴了以下杰出的开源项目：
- [Orion](https://github.com/chenxran/Orion)
- [RLHF](https://github.com/HarderThenHarder/transformers_tasks/tree/main/RLHF)
